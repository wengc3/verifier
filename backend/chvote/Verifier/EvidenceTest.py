import os, sys
from gmpy2 import mpz
sys.path.append(os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))

from chvote.verifier.SingleTest import SingleTest
from chvote.Utils.VerifierHelper import completness_decorate

from chvote.ElectionAuthority.CheckBallotProof import CheckBallotProof
from chvote.ElectionAuthority.CheckConfirmationProof import CheckConfirmationProof
from chvote.ElectionAuthority.CheckShuffleProof import CheckShuffleProof
from chvote.ElectionAuthority.CheckDecryptionProof import CheckDecryptionProof
from chvote.Types import BallotProof, ShuffleProof, ElGamalEncryption, DecryptionProof

def mpzList(data_list):
    return [mpz(item) for item in data_list]

def generateElgamal(data_matrix):
    return [ElGamalEncryption(mpz(item[0]),mpz(item[1])) for item in data_matrix]


def generateBallotProof(ballot):
    pi_s = ballot['pi'][0] #pi s as string array
    pi_t = ballot['pi'][1] #pi t as string array
    s=mpzList(pi_s)
    t=mpzList(pi_t)
    return BallotProof(s,t)

def generateShuffleProof(schufle_proof):
    pi_t = schufle_proof[0]
    pi_s = schufle_proof[1]
    pi_c = schufle_proof[2]
    pi_c_hat = schufle_proof[3]
    t = mpzList(pi_t[0:3]) + [mpzList(pi_t[3])] + [mpzList(pi_t[4])]
    s = mpzList(pi_s[0:4]) + [mpzList(pi_s[4])] + [mpzList(pi_s[5])]
    c = mpzList(pi_c)
    c_hat = mpzList(pi_c_hat)
    return ShuffleProof(t,s,c,c_hat)

def generateDecryptionProof(decryption_proof):
    pi_t = decryption_proof[0]
    pi_s = decryption_proof[1]
    t = [mpz(pi_t[0])]+[mpzList(pi_t[1])]
    s = mpz(pi_s)
    return DecryptionProof(t,s)

class BallotProofEvidenceTest(SingleTest):
    """docstring for BallotProofEvidenceTest."""

    @completness_decorate
    def runTest(self,election_data):
        """
        >>> res = bpet.runTest({'id': 'b0466e35-4166-43b1-a5cb-d20e3029f110', 'responses': [[['1179435489186344472602896965261160123519524039692818694499036874789648930592260158578229153715301705681054886441818548289446182443179764948481162050241774566109862113263225394225592238338280320783074046411906222671296834037015448286888618222161009749818732553479541740710377485389827775267703315723202864619328510037332237049105051502956462196264404989033589641926610337854643380523547726357578633336725549745179545844421024506718304675605797046114121045780044102454793635702549618960718087014356617771687899593446591546861874543909739239124515659812553315760187798030056069298662957959311564834399419309144877671140172808082594880938624216010437380928856210268515114174342659500678365139729759628171962483415377347432398395674737755509480247185182343255815307884355298837883454922081980786604061517296687210952961557019349235048701763796219013078609701908908278618075851929938850164883121100461000272655530112700711924008022'], [['9fe133387a43ec76e85801a7aa3104b2acc40b532a2a04e302eb7ef61286f3356197599aeee90aac1126f96770ca7e46368487396c0a3f1220cebf28933b616d'], ['97ba8ae0b510860271fca48ae0186794c94bc151bb11a2c615dee9fc4430a24f6aad1f70a3c1a382f6c071135922d39abdf12a69b11226a821583120a12ddb6b'], ['011983dd58f642e1e3046ab7251e021ad772f354ed0a93b575e18ca8a6c975e3ca94fe6dfee639ba7d513f3146b809a1705bb1ab8e9cf8100aa892229648a4fd']], '2538998815825281742767660886796155167233935943865621684451814391403465250311585509551017711102129066566146864811308294755149460823308127906396409734665388987648874815832627381517256402124625251481889892178084496244902135144010851256845168665019513846934111532241300081013968303958073788938297958245894161209968582733732377819974869829084665515969037715602458021587222983251458223740159181332201731544754054665343229604936640073570814573344051499447674346534931648810556779538990083455793003616158167762102353079436605025677223087145165368822265603534404596720331966618497848006200782274998077115438734178280308264149522230982398903319122236848561389426802899678248460727459186096612529669402748688987204655436462926669315566820526523699645726578511609570982280739622825970342696769264417958542020066946538356749380617932211797742208239978012366126590086880661770270729270557707009930270227901514201945627639279230978657460739'], [['3740829923987671902959795529034603056272814726731529326902414726447443220529131355144658828251544682999693036103899429449052381346246546070348766561328661337364727111881675092669402316183599531725903420605527629096548585475785943322173251840249242948992647011669141522566423139675172683972806636238555482713694545473917090478385493026257804903954471962337347229389630806146144228217095853105733662382921882757772189750245050244799376409976622471790019675845078047659058272284453865840799679031865423530958190633931395441020379299689816060324187020090812718985025273838988559266018238949344803043724452930420366776440541765979269497281456542638957699179196779672186134244901919446449393145051455839635284934302185971243493023663177855351704639679733195657937256515439626042178797789047716674754296067531902447556171861421397699589640844863740102494880996615919276179611409293280346845294655537465856272909051053915099992844999'], [['c284f1754deb88a38fd9288caebde9a2d97dd6c836718ac92dd8a59a2f137f44d08ba535c9f1e932a2f3ee0f65c246b1a7cb1abe11ab7e6e59013ba7a6fe0a9c'], ['4b0fafa47c53ef217dbbf434459218c620077d1f5f52a00250592ac8a55ffea982c41daf491f3a65610d56e52fc882bb23cf7ba74e8f8ee37ac44d054d55c341'], ['bee09d3e1e9f95edf539a0b8ef2ad88aa72b1832b9bcfd36895cb051d1fdd0cf2a8fce579790e3e8136d08260af754da266373521d21ac4a2efbf98aeaf2a6b1']], '459606206301342615175942835138413081888547857344959203415507307768482774613248245230570373591564567994340404048469252461034669109857139996168596893789525488259635215819469841961314823205075443162054375768191506247934530008795090218085434294177635379380851690208143611727606313551795437575580787493565029720308792250201411603086522472650295236507418037094647769099294575298665660379239449792484484002287388454501982785839740641045303593584599508116177241694729407781097109874971231044130637762776994734272005885328476459298626225947701956499758576608540874811999027613859825147779991590531002731528961357445214500375959902784747573130034181998082492805626553222537023498077417313312838152294167894545701135853095380866591583173704129738496123198650169681158387602826948310257659685032008766055007414584115755797574817860280590205986791344356092481630251967445918446364251430424550760695920541229063364236890805028493351393405'], [['1252789740988404123845962596725086267318400172518498369169547866781502930233501581712244628669335764246442482824148207936557880395244233882243524151828351283298832791911466430178987700677790057838273478990679845383221107764411861226245692596470862534474549574732886523795526463884868861706924853953511477724326307355814677157033348897256768830286225275277648120189163727885335867985656017557877388275913371853664932464794162657741123203123921478451323327474069541401400075251291305842972856454905361111678210196893571353393736735933485937540441403640104644395639197949963142571268405165904153048254824222615515283187523565941456316684251510030819812054236340178571441089463994415439685454641182017877273118827852651584855459309981362338053731791163719391977996500813440006751146881810748921762064128428129320692730673169814336577882397987188785955076809074280008867807653870026020281511921479417132554464276779541163126571594'], [['9f67ffc4a77dcdf75d8672ded7b533bd557f424181728489c34c16a71d4aabc473ba4fba69429a08f95d9f51b4c474ec3d9ec80c24b9e038c0e95c0e7997d8bc'], ['b75af31fea8d0a958f95f85dc1e78458c1f420ed4cdce960d923671790510ea419048f715e14b808849e3446962d2c53554580450d9a4f02927e7b133c015264'], ['e77a755ee8bf0e6f423243ac98734919b69b491164b5dbca16ec3f104cc9b3ef7ed5e9b1a20af066bb3ed9c2095922c57ad502c22dbe608551cb84d398d6fe8c']], '3924223019585799225507635965882715864661206769946647435544814146049186481576020228550541746821585825477624722729931343782788895961093053957336787851198120482229484230757422562666844312964037735338214090449151223073672202975953243057085573056016764511784707635573467097405957855247752519919605753210928043451035903676031182429424980899593078447620322999305368420320638579571012836825136214690808146132220218279377664067971607191779808702765229828556230890970658887008057349525997484324718839976473849996458900567474152142896180725184474972569103408184604062262760492811401463201426228336676965509750680098198733393318411277461582988104260819705423855747314358589213811128945266324823676074197601228792804627986119681205999922334895465387753405329246474683556946334763855445412658077587362196302248697607343652072981998014572271830138602475898075837890997765951424312075592214152710925811888042124384047561172551295234435776951']], 'timestamp': '16. Oct 2018 15:42:27', 'voterId': 0, 'ballot': {'x_hat': '2561117740318208691643329843082670215835865229061228731090516231134369340877725873977539812109114223748443088184674457698850890722846408658392966241056173640457206994643774839560325266954914865599308157208270101522456211566615106095976325151998397187040457995991040474233957332783791088439428561811261811977354590975828428677860201233582439772380120903856855362861368469368284982193506339449532487972085071244983349148363603514082012083910751435492596548405237759416700058614947599895724871053683589137183879129716179099569978619470323691561231315970890342205843252105725748406254803351186488076704814146452435046997872906305161080396843154941802040434165070693365379056341251752251001175514122683416485835621081517002700719660893546389946272223745742950267455909614242729614195810414246659883881252899047715073162717088672881033619205978248246917966548896441929080024739923399394652781298935677372113560799375871744823848030', 'a_bold': [['518460920798904338602631403269456958556087250035636788227841131312690201337423126741109159228262858677450698539804646020715159030904232408455232345817139860628931871534896109711667421532023942079052636279513244094054610871978901728647349080747192965680551485310306479525651054417691163857273548636844119008669698583242347655692270607160927668781159614526181415050190271585396404582055982126696110773110901885899629765528303928409968015710736871351888470119392646709757485320176062879028830909917850991061892952372219779834417311243151696887776630974819577535701117930295323410515272324878203809241384065154112993989985449008706654594106012950319243539578556278479017093341734722405110762181180542478334062128449072212056519886377697260401301183063480353636150680658891177956412747512542517539832125603509743163377934606024346096810117570079294542634876370921596492623113911959031739327100026321362895460373751606398194861294', '3101732690161449356742650592908116941229291206833242749954579254990577262773142764399348224313419774389055245140986997680694574239834964167851574680134957674242930995019955142231796548884646707269630244350366641355839404294275721280396092981224228358441047386567097492348272689041683974156568487144329482843626371697043916378107885570155384312257629194797182139708349193672124355537143247424774111122806389489370903190332619597869843473477120792295991436889621169258869043580302852938085298976969995762999076877061569622995685092585357744671182408179237348040131201380808360966132494707698698911575983840353498789827948538556145880250721983531798173275638868679130794216023872263678637156512990151360400344400865880556543298545539564953806273321451239268684623037838427120156447882286628084854203899597971209360626013022625157640159071773719153385678493734225755070970945588949855452080010419634877174205819894890828309064126']], 'pi': [['3632700862323378077815898906418336002560251830338855062817772855675602968945599335348681286748610084948260915076073325085658409294675995691058777072467664912026413263886833255406516718401833872176076928953523485191237156250708477579034707151613580208127104395251537390582647564380477548509681623003804894403824610537975236380969297602591143029655526447241160414049204776542515329701190200868563304400498242807096505617161037150743607278699446968985546670138625034217193131885950121252902386170570802382410894935165727162489241044555129149483110694546913483982674103844513822035534565343362257950198106448524954941715893281526805694576712546483794532002747458051892407935368802094981965730332070953204647407733400712230542101475454696045842708111234619907200020345399535533536093560017354117483056354639029745381777716607381945820378320555669270689416628417954287399609018844798792668221457334077042926170457179839546906856779', '976494565863327977676988530040362744788306296335332993533764314338931925055306522907524041790420758556073367872693907478091542173359963452079713135798790589481014380381416533233711196286335389968204818656090848672481422079543464234703056639229578081615216709093808566829998212994462951860656862310152312467431185526644558169465661426756319747638185971832241555507396259331879110859370841313950190876178922062074817084126689875811686479032231044796070673863683972323900194129187351391022158305397629241798238515030268726247203658368319431360477625640851176837696427641171070376198781923799193686503017500223249580608196961464778466514196824907845210253084946061341807463537367704903310470355605001987815187638192959145446548328904377106929698027737578584871390511274698113383301993008260308281912652264705005117164509068278542664667026979507105575126304352825545393659736342500513789055863366456760205712920041627113267361230', '3569211828038304480140786738644718591849014820401746687310181416507742121562425051293814893551852204225937396743143906153798582304551066885659483882577565709909873832495292555408342266159510297698158002252496581318052221734318607715839119810551316035832456031262800634820814912568760539221557442231758834591256852825275910368374105041267118005924469788529733338622349571971933221896314544114579834252360975395317245067030437584807194958239685019670733793759009872494158084627484723972184004273272298732744883568992917418809750016181595023413655428763683530702218146698391134608969367692193661841124399351341330850140451515244849199153730607676607509414743232274097090449325345772488104552772376826614928504945734646375830749997178503393731292653989783959285593847308894177909975205399081561439734016089119387157726324744142978898266844777832498373955871591731264085665240106497293748797828278868975841198737319135605565901276'], ['21345580246624678974385993985750615815160126354454116718224859113011541277375', '2448319314715969119603714142339380565092057061896156362023151506231983340340757429532031824729599698961348473907545144479342243209971992515351868727120593548874706952900656103571179810388695297784610069786594437148586841466166249144692407972170505290883053249941247608019665896407812873275236037462927221430023204941371066159944018669584057250646986512073593685408174579105978263593167571081541127054042326109422749865533669135589392874806524685708316499677899332115694901279678011106931848701674301454547231449117796590180074503670469441511262780092897290096141498548294797332224583848820223085709422962637960248944010761585778051176711533487764457285166066797211336980631422601190237894871927859838162048362132564933631023974487566180472427775391217201777976786272767407565072035077646024254433019020382811069881625046453870650442019507414586528665209346002452861676748216586264875551861626052181437535712888832968090820479', '1515123920188101567896721575448298731312809221195389960645661144127723063351612688313842223860659603792487756519325534488167386933708249841256131635200462151019680605828728978250634203177122145425146417240199299258139705069452671418006892828089791389930416826770289543691253496637977390157854628739309552731241714711270011977871082740379262377041884710241611005123397985853184890678825748606928298160709104726628841695089184264051590134844684591713745033290377359698213520515934284349999483623570614608269161828740437923976632892899345139986939357880121867774961221125080861431583190264092808845131912797402637992695343281601795801972097150657599426468049257328951265737471863693297206284935157616233325617859544664773717673468481143929452567201798881624919658202257749077478867697745244394547968298682370858186838006557147164702477340234185357851096113036559415432327595153610117331672252647266303668583710517030122028029828']]}, 'randomizations': ['1630600916637401031262359888649953887137301017547888551028897216576104361832306502829362434715457200233625853144950043330576459414613591381725874997912044365412421673916518449653379312380239429635485045932149299967739471662397952705158446687049141450565001937839600548384229959127979933960857451628927720815074895357711053788010619509675374564829315449345150145756767680759236349261444535196491616323659914626018510554607374381461666763074415408045619521457833688610551473566480898083992993512198753756639958891700215856738844952374750206651469787074526032514967302306340312561715427159528622239207747216949802187313518790440394692925596679935956269400548723750354516948440205128226092485723766076634143151012168436241748729154331085095735741457423994801414420166153586674773910958549985240190932652966434152961303051164599719084350634617098325684696118404915623353756027720862173765923940439943332484042673480559283366667982', '172985431213374429574681490821033561947003175649062444677677715446361070311596606892056814763449625642288012582552593679671820616038830010457188541090868078091707594427350992235971198587807820355787556738695620375874886314742414648144047650532192263304495857313477902293964536065277755917153067388533160647428196127533063940006548871741854945074844331291298094613573381751885765908408481879579222074790205465823789184556308278826610757389901298492721319262075930421969055385898040247780298697449494096975954096250228437714629919571060984068759996130104972213464525896127057855572536283407054010634350233279330726576251473228977131553434311870777499801476175865425777901295546331963784432385269555468275518376402258343405661127664075560743290699240953429238283790751925912398854915924537978981051332529829945032722947030934634691802650589096329772190451340215377225371563757710146230226046825299706844953942546420957995515873'], 'validity': 1})
        >>> res.test_result
        'successful'
        >>> res.test_data
        [{'ballot': {'x_hat': '2561117740318208691643329843082670215835865229061228731090516231134369340877725873977539812109114223748443088184674457698850890722846408658392966241056173640457206994643774839560325266954914865599308157208270101522456211566615106095976325151998397187040457995991040474233957332783791088439428561811261811977354590975828428677860201233582439772380120903856855362861368469368284982193506339449532487972085071244983349148363603514082012083910751435492596548405237759416700058614947599895724871053683589137183879129716179099569978619470323691561231315970890342205843252105725748406254803351186488076704814146452435046997872906305161080396843154941802040434165070693365379056341251752251001175514122683416485835621081517002700719660893546389946272223745742950267455909614242729614195810414246659883881252899047715073162717088672881033619205978248246917966548896441929080024739923399394652781298935677372113560799375871744823848030', 'a_bold': [['518460920798904338602631403269456958556087250035636788227841131312690201337423126741109159228262858677450698539804646020715159030904232408455232345817139860628931871534896109711667421532023942079052636279513244094054610871978901728647349080747192965680551485310306479525651054417691163857273548636844119008669698583242347655692270607160927668781159614526181415050190271585396404582055982126696110773110901885899629765528303928409968015710736871351888470119392646709757485320176062879028830909917850991061892952372219779834417311243151696887776630974819577535701117930295323410515272324878203809241384065154112993989985449008706654594106012950319243539578556278479017093341734722405110762181180542478334062128449072212056519886377697260401301183063480353636150680658891177956412747512542517539832125603509743163377934606024346096810117570079294542634876370921596492623113911959031739327100026321362895460373751606398194861294', '3101732690161449356742650592908116941229291206833242749954579254990577262773142764399348224313419774389055245140986997680694574239834964167851574680134957674242930995019955142231796548884646707269630244350366641355839404294275721280396092981224228358441047386567097492348272689041683974156568487144329482843626371697043916378107885570155384312257629194797182139708349193672124355537143247424774111122806389489370903190332619597869843473477120792295991436889621169258869043580302852938085298976969995762999076877061569622995685092585357744671182408179237348040131201380808360966132494707698698911575983840353498789827948538556145880250721983531798173275638868679130794216023872263678637156512990151360400344400865880556543298545539564953806273321451239268684623037838427120156447882286628084854203899597971209360626013022625157640159071773719153385678493734225755070970945588949855452080010419634877174205819894890828309064126']], 'pi': [['3632700862323378077815898906418336002560251830338855062817772855675602968945599335348681286748610084948260915076073325085658409294675995691058777072467664912026413263886833255406516718401833872176076928953523485191237156250708477579034707151613580208127104395251537390582647564380477548509681623003804894403824610537975236380969297602591143029655526447241160414049204776542515329701190200868563304400498242807096505617161037150743607278699446968985546670138625034217193131885950121252902386170570802382410894935165727162489241044555129149483110694546913483982674103844513822035534565343362257950198106448524954941715893281526805694576712546483794532002747458051892407935368802094981965730332070953204647407733400712230542101475454696045842708111234619907200020345399535533536093560017354117483056354639029745381777716607381945820378320555669270689416628417954287399609018844798792668221457334077042926170457179839546906856779', '976494565863327977676988530040362744788306296335332993533764314338931925055306522907524041790420758556073367872693907478091542173359963452079713135798790589481014380381416533233711196286335389968204818656090848672481422079543464234703056639229578081615216709093808566829998212994462951860656862310152312467431185526644558169465661426756319747638185971832241555507396259331879110859370841313950190876178922062074817084126689875811686479032231044796070673863683972323900194129187351391022158305397629241798238515030268726247203658368319431360477625640851176837696427641171070376198781923799193686503017500223249580608196961464778466514196824907845210253084946061341807463537367704903310470355605001987815187638192959145446548328904377106929698027737578584871390511274698113383301993008260308281912652264705005117164509068278542664667026979507105575126304352825545393659736342500513789055863366456760205712920041627113267361230', '3569211828038304480140786738644718591849014820401746687310181416507742121562425051293814893551852204225937396743143906153798582304551066885659483882577565709909873832495292555408342266159510297698158002252496581318052221734318607715839119810551316035832456031262800634820814912568760539221557442231758834591256852825275910368374105041267118005924469788529733338622349571971933221896314544114579834252360975395317245067030437584807194958239685019670733793759009872494158084627484723972184004273272298732744883568992917418809750016181595023413655428763683530702218146698391134608969367692193661841124399351341330850140451515244849199153730607676607509414743232274097090449325345772488104552772376826614928504945734646375830749997178503393731292653989783959285593847308894177909975205399081561439734016089119387157726324744142978898266844777832498373955871591731264085665240106497293748797828278868975841198737319135605565901276'], ['21345580246624678974385993985750615815160126354454116718224859113011541277375', '2448319314715969119603714142339380565092057061896156362023151506231983340340757429532031824729599698961348473907545144479342243209971992515351868727120593548874706952900656103571179810388695297784610069786594437148586841466166249144692407972170505290883053249941247608019665896407812873275236037462927221430023204941371066159944018669584057250646986512073593685408174579105978263593167571081541127054042326109422749865533669135589392874806524685708316499677899332115694901279678011106931848701674301454547231449117796590180074503670469441511262780092897290096141498548294797332224583848820223085709422962637960248944010761585778051176711533487764457285166066797211336980631422601190237894871927859838162048362132564933631023974487566180472427775391217201777976786272767407565072035077646024254433019020382811069881625046453870650442019507414586528665209346002452861676748216586264875551861626052181437535712888832968090820479', '1515123920188101567896721575448298731312809221195389960645661144127723063351612688313842223860659603792487756519325534488167386933708249841256131635200462151019680605828728978250634203177122145425146417240199299258139705069452671418006892828089791389930416826770289543691253496637977390157854628739309552731241714711270011977871082740379262377041884710241611005123397985853184890678825748606928298160709104726628841695089184264051590134844684591713745033290377359698213520515934284349999483623570614608269161828740437923976632892899345139986939357880121867774961221125080861431583190264092808845131912797402637992695343281601795801972097150657599426468049257328951265737471863693297206284935157616233325617859544664773717673468481143929452567201798881624919658202257749077478867697745244394547968298682370858186838006557147164702477340234185357851096113036559415432327595153610117331672252647266303668583710517030122028029828']]}}, {'publicKey': '2721018155699489411542213056148012074052548113726642889701705112755974737451318870255648939276536172308726828572986940131789368436613219844915287835481165590734761195639541435331051524855521854004971090570064778435633204661632995007204823589930770485222393106033645761082534695313982005400917478953969095109685517221834872259559238200644959055481991881762262704667193329088703278187372296350722554961668836448757383681843902280286615449697297915167726451728816189067203276968235029469858344878565257106922744103950443320762023379659397505592745669635791069760162432753771501779025429624848121258948522679005382255951348665467461363269408313071461569127288632157629560144718895730885155065571532713782441000584472697839126343544473577771121534155938149261811636395690149372622474785591950134351748590999532278350797080995783529620122118764546357338006914128794048621503454893219354071153072681922990346519642879590224417334562'}]
        """
        key = self.key
        ballot = election_data[key]
        pk_s = self.election_data['publicKey']
        secparams = self.election_data['secparams']
        self.test_result.addTestData('publicKey',pk_s)
        pi = generateBallotProof(ballot)
        a_bold = ballot['a_bold']
        a_bold_s = [[a_bold[x][y] for y in range(len(a_bold[0]))] for x in range(len(a_bold))]
        for i,item in enumerate(a_bold):
            for j,str in enumerate(item):
                a_bold[i][j]= mpz(str)
        pk = mpz(pk_s)
        x_hat = mpz(ballot['x_hat'])
        res=CheckBallotProof(pi,x_hat,a_bold,pk,secparams)
        ballot['a_bold'] = a_bold_s
        return 'successful' if res else 'failed'

class ConfirmationProofEvidenceTest(SingleTest):
    """docstring for ConfirmationProofEvidenceTest."""
    @completness_decorate
    def runTest(self,election_data):
        """
        >>> res = cpet.runTest({'confirmation': {'y_hat': '1484121251359951826104471183378273385476808659179653987458913813025841039653028785875672202336141400847991512813054120103935105866446806105895660359602490911310084175136776030446559780778246070981959478555394811620507184713378972350067472848892554269751032260991199573004127142879236094919867447026005955096669712367606732047320841147980072831354851596478690750073999300188937151468979473011073755689418365913019492171003111908825585668343259495256754299745904149779795126122788297864413663488269865030395733023170328151692094989593165899588149012782159359453976811095077850581949211082630987254356304167673355577013347893952834056484872114681455870432581919766422480245066971872362496657711569548591189237322304229753237669246240033521384802132785693275283065907181656115077843889953632434911395273755410678927825165762887206181668571329435823036449631952013857352705434047714317685519583000937405895239259979218336208892373', 'pi':['1672080953091796511557025684900844296353395227467030452781712449256225585438226809989376622796616424380092701992483510809466227459274137363033908273419033518986698324069161659406486296488968901394308170243560930766099641749889195282336128498971857298899639466152908095912659628607903985043305766334618549315588681125937334308567704989951244281584203353105355381777342588738643402509160434824486863954723970280710373541330320274618623983301233986587503372044353502768938770913960911891021681376089814871666648624632109753345178420658829721008540103904368183333282902168431883567720908711672612944538548222959380666958586543426722994873960391421586188424068282816697491148607671099215614692287764866437607483950628639915609525916412333733433730599227769656231541104561016868030869459446164614164007151913126658296340926113224092362060033889607150192859800949026609989485910677518666063321228231215086526289850697572284247507919', '132974664627115262935730375367823913373043586563628781795029924533025538885369']}})
        >>> res.test_result
        'successful'
        >>> res.test_data
        [{'confirmation': {'y_hat': '1484121251359951826104471183378273385476808659179653987458913813025841039653028785875672202336141400847991512813054120103935105866446806105895660359602490911310084175136776030446559780778246070981959478555394811620507184713378972350067472848892554269751032260991199573004127142879236094919867447026005955096669712367606732047320841147980072831354851596478690750073999300188937151468979473011073755689418365913019492171003111908825585668343259495256754299745904149779795126122788297864413663488269865030395733023170328151692094989593165899588149012782159359453976811095077850581949211082630987254356304167673355577013347893952834056484872114681455870432581919766422480245066971872362496657711569548591189237322304229753237669246240033521384802132785693275283065907181656115077843889953632434911395273755410678927825165762887206181668571329435823036449631952013857352705434047714317685519583000937405895239259979218336208892373', 'pi': ['1672080953091796511557025684900844296353395227467030452781712449256225585438226809989376622796616424380092701992483510809466227459274137363033908273419033518986698324069161659406486296488968901394308170243560930766099641749889195282336128498971857298899639466152908095912659628607903985043305766334618549315588681125937334308567704989951244281584203353105355381777342588738643402509160434824486863954723970280710373541330320274618623983301233986587503372044353502768938770913960911891021681376089814871666648624632109753345178420658829721008540103904368183333282902168431883567720908711672612944538548222959380666958586543426722994873960391421586188424068282816697491148607671099215614692287764866437607483950628639915609525916412333733433730599227769656231541104561016868030869459446164614164007151913126658296340926113224092362060033889607150192859800949026609989485910677518666063321228231215086526289850697572284247507919', '132974664627115262935730375367823913373043586563628781795029924533025538885369']}}]
        """
        key = self.key
        confirmation = election_data[key]
        pi = confirmation.get('pi')
        s,t = pi
        mpz_pi = (mpz(s),mpz(t))
        y_hat = confirmation.get('y_hat')
        secparams = self.election_data['secparams']
        res = CheckConfirmationProof(mpz_pi, mpz(y_hat), secparams)
        return 'successful' if res else 'failed'

class ShuffleProofEveidenceTest(SingleTest):
    """docstring for ShuffleProofEveidenceTest."""
    @completness_decorate
    def runTest(self,election_data):
        """
        >>> res = spet.runTest({'shuffleProof': [['1480087838687999167062277319226971465937398361948978274707177620948566648158947887443778075355786727283504482872057690365959166730453190661705498994966826611211532915013738003276107626571651493692562622786367479412644735268590556815783391245022975075238800164180689536399270977580972527519394411289783797442934321450170232285313916950968074179587743235918981784470174870877923174520421226017060743488051123269710434092139375033589815933577120323070201479153618533690271564291278766919709242079275351726228669769175956071768754349852181400656573533435625890370039947811031592353292327908040915715284998119942688467277259984379747580274991900799752536064523123588895312969400352579712157808515386261702471479371581552638089473706377244795393548370568509561973714473872948297015756800023897498146994562705194843155909557795876732844431713021058780230349498250949884936366280832566749304369077990485953443189018945331081579260533', '666271631535156629212810650139014919111978117934376212770194555116520156317377673809338778123454387225319467678165313127748703364713982305534906201188528767837819967889126862957837600657868468772930199055502079815422194365220186899549993047142195653428220109192511318189617891422414072869541825096382370935550652939682331396492295833561392918418009658593600292065183962729733563530649943816810545819693080740424733217910783278187728586357039640191108040001917880078272820776036273095983972821660075405709137827278434835612791331910737829138935411072198436259060167992536676748575402165188319033310975424494025065748299770831276568503502149424444843933294528133905275138645872111799795111569092049379634585607392439227227990769992673669298709824907717392759720692571525712477638505579054035577420120287146088364220902118990132000298701189716790477775907960288270560164037144900854105960320145629100053562344301809964605747933', '549632294048505038562638275242250808398936786190142619330826063197867660647913978091714920130241525179440118366553261236710149004983503060836711081007812974364223930533527047493779422964412658287718174688000783682663346470347465048443759059350951663506998888862122295354606947430840330400905626278325125786038494311649830820495720709417773633241796906124864657569381377992935684174429550724205047964940329614313102738513356037715391821239691176601915652379208506816230978713195174911645804814089253418098706933679099719953141323016063030592707021402751663488776023354985911250671144986834095575945758267121197657771661894235533107423836920890392686508366025524106788255744403923148917432846286510392322154971452800735342937051838915469999331655270919729378544426424508565243049098104066440836842740897656176490802047278021043063436493381967734264083620343483688348635186270042084223431304911583547704729913542731482207962640', ['1353035036548180823616557593350235149593153904045395214924516243526022339741387540508001388007263824310099317536124724333537544939913756092488944348824365107148271211248715201338235624176161880236122273605686943974677899827052326451278139124152838613949077236085357719817045027199825720772785524057780217654619141011330788154617831421684639087645115031058537575598160404488276822845299046008034040226702574079655296969483714313675239394044262114449204881441971629124100263689642976248622123173936746276594270267934113023831550178639026475447324473441415522698166227291607562506320226210700665877234921573591887383757444368921346211626414020602298256691346787766566353406176244159180807875700718533305786248115032235550087746731198490704525734308787210166706784529902713684480502167130478481459406593849379943160615508232388851823919219251784293515669726630264690093218511749261407987909455246227729641773135908224413262952022', '1355476328598398243278414207048576018974293096161773658890862702002784104614730264094803160360940779228121183523506789365114899279444822451226984193479745743007165330616418917199270151292321241442079707546857361165240633869151496558777827273557964995804872152534566037104646991687527131963150863951133241363145294170780253911745601443747448783787771443448851122944549331468444096960321287377227469110245373029783896817375211739949762328075849806905712832066687920838222531137721451618453835173674016051763036409615368500579153115663990977095678049890270270570851342401178918207939358480052263988368375698145753098117087000051105496855764879119137290369881524714803135219028176591624107096912255336009843417075766663573818608050874571943883821380049045140092154532826259364913032431573800579963433750058393221192900600372045149501548634516080042650074136952386375140638401633763702653344990733528010850112208035821765000595235'], ['2614267985772886894184317509569892916694699401632404828409578738776831824994906619447935080737203421537416388906652966474508061397685975656593852191607565737368180991979675677636572867773243843962868004287347721648821217582813993280581345893580749475977382921211066571232959560150968987741065108396582231161686895662707934932772315495544616621171113543759650976588187117766579415134501790123698549069081632910256530704923224872655001930060695983622237189512737085312315320360866787916820823993177033252774340799398564360155818381739972024286970903609815512857986107675011501933631730919918239175955807532955155667325356969032510780319857106436875744131653519404742751413691162942181438298245217344968996784963299750609106844704999935019237711681203549899606706388176779484836818831196845335239822554848464492315625437119337836038107299995317200248041583736146735668886825310827491156568812264019833434792501004434736023409439', '3895796024847061959417117449946357088509791621722146585835948032430649729502439307782237865260991975050859067549911703104490343661502769410833020587276344567624907622232213518231034747386541405735391810410317926369063797845715880170370027648146054662138303422570815393261440474636829994886349390693171092285724203444089457365181497533166291482060244226551707545037686886909474232368451664159955025606605941460220632153358127317471110497707025519294199495570048341197434774672336060337181922023649930269589729056398948005755152360902361106001462779415955067495303597349423695757773810949620737888584649132197670971470879525637131673916746181337447065642769197580146857450042411008593319059896877330822151790902518678388943916613841279972728749770930709567786416982036460454517398580381738691140408001685892357033166344729210936426043486518687215000635547644251281876844156039095995135040156609115045547797061421003417145443101', '985581799131106571383715527077046014467938002471837251737723285955864689897333642923908687040982331446482010279083889980499544130558593082598095744729325355347541093018020613663717818463430111064695121976032467220994831992050451625526517052632831995956546198263911782273308252635931886013272949850617998403947985037768969340900793854531808222631785212774204817425295055641068735872643976787014071449171714076550747126171598081851221764101361548104965848133495741984218980130374318122813435265879760512058533200651468808932578174750351811385974807062850060106895602983995575716142191127054528376112610151192202915752272560160053099310222126259914211490899492738739770559137585482856183706287318575381843121251271181838295650099527743731591078038941001335970064141739065697332768099798885921275991025203823990786851163784671969074709461064747456959188939940825877916103758347188472222942647160564375082681394715944640391382809']], ['85135495924905705055856679318705350670233169867386356519831585610048703163626241677756111644121348030234477543188777457233408986202530552992610921771443863767492174546953908425011107616276720775845520096189476657462198002232513146021981871891959116009438425271949247758870054316885029156468744234503734704921159369138419736206215418632224081921740692262503558170546281289601700241516016043711177946252525565951879776163552337520900549718924840195194315507421061729553098506150916003657632280782373689003749358246811606525410333479672150250367364550897639611349429797245765220661209344292221553588270731923247143004193962176590611529956986468648622956344947413842779249903827611311725772218866873599230007933937883575897264415582276837373544705337336845778763670953758886272505817327064256538939687601354924316430978990242868708385342133252365760789305546851057661859320648974294226398354214679736375931955290569032577401025', '1368055697143258654215362814359017702241584970690773731703263379023200482864856754852770734699501000618673022401612691387647209202138662828426186412806972619233710662924323906244783930073787155328185431271740351647606455230539964399652827605343498424377838242230945380109578201502836528246898077014625619473284894241318355723635560231441736522555857648565630592932145818449949623232424164189066202196587855831354531440621742062054032767418049994786198101752581027858495990256487521156823828935795229262508142425156514042093585531408670210101043221379083069067100050585030411097463834351911258450048467679824008360907903883337241190055400622549465745372901594072602290632671499327559521192171064354754202529433705399998798955635285885183151760454058540272961231133748411356408451282135832179879831793238032819718935307242173215494584351842754110853570617582085706633672186457467992022862468943656967251133434039473379003572772', '681439188504940886347921701330590422538387805937824111157341809536097072088009796901930242438241054427545295553215907081085163061788477867688043000112688934713275323162249945173989492734865830678636398037523657930473390281465362213433216171592082184847653382760729223273329437427249079425975250857599822940382733800964287451451033889260593981149116712904476539136434113688438925003274995403465951229936159789245359648961043990675710946884225862317830163641620211708959937688539445430329419448591151224296054139596671027185343228177788284887106084917373007291423710986777597461497250782797587235427980270954331680045340105623319712300716066587544266682574970318856888499876939969816505488308722548968488297918693965304583961039373670335455109387710860115373840511339725381991798254001427839231024012184052624570825487721985962308752171808193414475356128333792935466496695906255045317238173508972014566956100961410486597243327', '656515896378874197451641054075605506813920820666689581613413533660705579821455784356479836346120866473256728648992669570343472396931478169723042812945233928129101168418029318397626877624571257401582795314457612835227406904036342121185606901063448587157234123692467900896089128214560231313747542421717415345400326607198045928342771101197446645325818141896685285465781840386993472510977238180045778359514485615679817772595137333445383373953568462427862112117139604010986247856298512692844771353848454082089964058839411795670191083500963173280965776220050785650643792043260266637033395379464898604081139042160552535795720394328301945859152459500482632181216859396122002025542597662525583466298330064021026953630919621297233481538865413178900539775386182700947896655097511564872388614806660165850200021036272502390857123874364021313336868278411412881072637519928072757201270209421215636307942477552722991968851623679452308852091', ['132632084079803441861112875863696211865129321284969660371641351329778117514545322034265844752510747275713161708216534437651549123460531349655348967684639235575877421845772917269972206310814824582687152371658505389540702797062557290435435085008878284774993582282533179436984705835543763256773152254094360737605739801898826976692887456493701293810019377103732287263823433180979037439603305839023287123527812146921778278196536631555025863131867986302403054114852633219660921297946893619974425935120385635177996372273408185289142681473791331236210186321417541647595909323483695534631492389298901455611383944598139290224540832407911133412266167283601677833276882433316570810942463047266798800308734758494887167913113778519741271416661733050136968780083654226962255752653056212934511247471053034378121525006824624016524479623299096692212821537751889289368365654700880476697937683192232180587048178505320475951513721105804716224667', '793256004408457534661443942113759213930627686110846208903590343684003391365184517601711916712040926420139482437090737539761644681440359122946035889751577817488144282508573371543899903202890922246067272316109904298929193933589681705731557402591650350104606219169196559347156376110982620408759542411104611052011752908938847132222817006401830113286407946062864265244832002963830954910348381093322170731155548902561002529628099921277052459203217993681468844940880673926613393409013896471610201456942745429017446101920216295919944356224258037865876517300877576998085135784556523874597047465696945833810251218892730672188079794866546643149649832931299035254384706516284812337438296497843795258037682369990178543075961442459940455061890569322528985970327671188100159521147135809251919473521929193453544938827542478104338286260435424494862583063069658418314282285322608263360406749924033833630098236120690144807149381693351027259848', '1322702790834028978487893224794528913180885957676590817389276391353968298446361939622385457107339954770832262119444967819553684912467577717736314573215993974146980710859586062632524439017781583036769221420284521946885354551467823395704110949440174682125858260209620422093229559239821894932101634194650488925030309849466815151641714429344854954261228982343185383256851767916019837518330697319739539188876709625759455630732912871620193703578443930994594240359860700040557604370644054933623542213066841584847094249376982330531445730306761573431999559550477286364614729121694336350086003400616696422838090447743237601091512606782901603983746987231984840952181169566127616576847273476971826125963573916213837632300268890912794406171131421066903932012417828101181131680979920395218181578011880196315738164576832309501436184828157477190909988196779858284023330308613253358185320846538255965932257241130473793678642767030704289470223'], ['1878517148374119233571373341128843661569250090285200389184792088332612160610941917207326906065475926505034573341322822128240269900820713333683036127615997249537219456189761215745074606492944012219023147432471968845411248149336376942965763075838873026112098929766152738022605485397086529639332601897368498282475724926269362788159993087482738809905631818685976704428415545875316855395388084440247982511377470876021474308028962946454316640882386346336869472638967878578310610952299984324531629023950821274985628441031838187758109144636472108437720345461487347614073275229890981069614443552427129213386530215257911937517413492573135017490901865379368126117186491067784297477514555311028467566583328473540623742852502837251931757846696253716919380331013927364659209696565798803710921092529700539980087673660333070579968979502445747623934075599002354087483860467183541716838611245151279488148873716531696497450559746449190187204754', '1201039578284884620649231693786477427632176483065208661261237803398489594680200460569417416226606438990299190485482822936477374938569930351768256462468979593165752565927392073634552678436264893727432066049270972465968022899640791831187260521291308799245988304679173723980119087369555688282746574842439059060876477490279561038321105951212678578299138363126051627977266588176629166984970071355110332318474037038038086468686299087037165210499195549476375338169766778653243781308105029789301133159085759997641584199474728912199487508708062746731557628097826664473413161014990886081438118114941125867021297666801053243428619451509730542694821070499504672708680900178211022843605201729134716683290875996055970825010700286616633752473661366075761058225853464423861059414087687064042957398927249013911189768565781573459181412948233338038022940808363049466102334940950905252960925626750777314131769273475693916629593204843423450113043', '1001035605549966437570592262277361877669001253514482762171777343942126541335527240123407970533469108312234521975331686169655106890330255190480306506393122574802252943211586939533331257427233519732797249650584060793081570386311981540216917213208730739506740906419066697967639000969122326344503867869031014709593789947053604052438897365569420610628124017637620009487569092612504169870039745436936781282371946156115795834829910570045292305068578204962642863319864607981884689220126733560583315783027793376094172298067731899609380099338907518579201276578238949632802032054542476129998748456926048968652798548753237166678519460487145237061178997183718771957075050144257441619496871865850180801760192232692729719988035697091281256352472752195568089418833507221261923805192702370377364484022785544246544118006603944311605381200236907712441135237840823761821565471018641839819803225713517340650789800509335395092651923944705742236727']], ['2982175799558336604400109773033690150175235904821223559397349544806063476526939885869018504184669509593845712292506588443297712023809181088617468149454777015783986414210139929539031895194021158850494357244321860460310053492932182543626502970743290879967794306663786688143982617567097802039213544975067717399968646689341541728559781490291923799665958063162618533753499238064050269035709418878238661600369341218002536990167623440342152854706849828048512254531107539810361083986963055736427493986884003904161918503417858510126788981661513025695616699026363379428097177354924657246710763217599798606315855114036918908751334738189211650303563520379732356709176914731024568582164548255420657490924882894287311256339542807086591497729044241476905156361838872741998490701039177501844328030328494910569919930767834033980009009612021044043735311183110871902223967197037138516419111645163264869932922311082613053795518623951702929570511', '3762053468234706666063122157887779098077686267317956656807384758242378786143285167434585810856818004509578757122013147999399509849988794506094723955406942417461741483485474049164805932810402122260391882050885870546197018960404505593575022093260708269883520038565783580263281736821780883513646018928041155245604580049832270132399630550396752565299040924369797479975165721298151649767382044672397324581394842734368757984814782451874891342006948319088517007245862266481894050738642756158483920500135751258617857893313241843854081783124262319820253216613731067514391601694396836209996619468584896666443394048187387862567745283795171046265509331359017541829156485648004464505235527286164521394829928629386492700715543490370966870954807715265533467983096893610220098967491816402946263421304779634110289354946341012715876467613878982691840464315267200516840187464980565579015545239026818764142066143907206070016602979118840837926619', '2452051096590804255103235451615443640583934189111652483050265925343546427739839702267367581175387204482130017975105916864162312064496652714490302664094308978621992061857475992357049576450246529259664488178948948392545927454195345141885209956814750601103457573811025024691876708166832311055391151032476721530138381657201731919803995533384824185774515933662903519477560248485005746368588857948642746749429877546774490302578354831621110558936018353981111921927307263535378997832238578942815422095391587781987466130856105560309681495809934222501390320602778722825881871903298865753951064475088833259157789331099569332834877863396804622090456390906179862111393621655630219051784454696070016357543344943778296052336133049253956347388491158668235568961567322711890621598264810175210049926693240531163858434144676790240717420801464712386498046786389994541003250399026510493345648071751934041185477020352253830367395121149090256963465'], ['3878512475332124260862310438329614370552989933380718568135529154010054420623659456546087401301293471016975827577798771560979765983632983246147519433474505613336105349112985510829083068213975755341043523054261492104104162876814022957360261115180488348371264976428680899735356232532728725239467453642915426636155739819302157604921287043236865183570819611816684075660624585290106385733084491802849195845372611098727153687834523804395881886103460000950120504171228296285210344141615418663402487015106290553271104604080735431603926750398268264887216652509613864225426905481047738380167512731713579120746405666546580113048761508643525877196017499486515122695975073517013617498719735441552189090503188098499399691983318939074578581520579992399865718620151183845066653857459449455456975998055889984951038679944755484142167267583602949701032442790080457656047523289991442836877298620185499709794280239356755096776178926370284483283699', '3425600022911430570310722110019879414024030111972911649988123066029865382461387113812638128076308532951525887855934027718967986698060025455772171774723698959677436875450325391029709897218339068101244529210093747361863178525825481590471412439185020389360896255929328485900004799828870643998523768364198506398671639269390402024508763376133137576004565413792687959477373873256385936068798653912769214541723158794292089515262827533597646230459577474589626200482011984405194138993816760956445916798699308488607657070017291142948220182974430839445341596459021539149648929582908227573455151295086874442183075050647096232313360168403132910295025934180815551808159034436442022358723003563059120590411264993506739028129557812067709476140138097723145430516620732947518205482439288966610315598024354314264866646157996407990828120453683918280246403249453406092047372875630901488438646954268840736778709286252813750279446806675527461989421', '957612535583297116848181642522746934097977445476906965565137367273466000353972728199582665611662480875324613946961400473969323972981158936704924538466104907477044115818857624694339012285954101418332890970223563906975196561090214430324332789863385462877577091062053672626414004031437257358702248367010777259636671900428612305865172008978463188644429811700676152889778768544478627790206798168178203323858647032791280880333463706115761158148609384143648929161909692218553771424747780888460081780517887558149906791768854377112954745360216583182038303002241378804985994167518197921020576971794133535690421020383737352783490098014768509004388651007427621046041373068398507923477658772302721803740965396309509920902118894018087838321837372424235083638331303697985030890831863095305152025284828433979381455701477246167083357264747255870761931302356881405232988440076420483006821889721014101747968800415198263641875352253281585105810']], 'e_bold': [['68785260378456542557073271513036816577586820295083094050721886015677969665407531668000623748217715650444337315319413405293472443816641624739999581873917066756573828837749251623839711379906834902872189646734207156862719071582211692965427459949900470719210607027263435308456562155095769065438817672371361265184838413313577104715991535227504796117397626726960625495414391007033605541220348339909640098340072293529568133133908051196836127915337487646837671712085743594921440496584550776726020887933382291040254526155757310267675205475738461942212464164516828689746485791061337303405840954151462452588002724989600914308866676142209982670819806771884792662159919842583525321909903632188194590528805866492040595817453174922900567486114410794019861277106411395137606048966039598257198378054253013192344974168901324505611352478969725264595755531612644570608641539375903820249915550818882649480787326989220668392828723302399799890641', '3436817759919294212399143555402108446601109498989054778098995541553326644764908378343682137419048725957850751003047627572747505060404647554861397834887924585549557624284281721957627584568549117170867937775046591142450570285415431536718526012407078553413772858952388343175140913034262017463807659611831765528980088377693670778475992261217837908634781998763119866482282892141004931493520896998913615066538609816861645429767796739776336201245108219157051863973516126297393890695692012004867680521649163885267667445577771520931833972215072498887415730353641672831087683358110139863065950848148549160101524200087719517372881393449979441930491196839017909228968236615229060022065998314694836763977574639478466415859451270919845061829119892856784496635095103446817295575748809689583669755270239128368033763524665899376594409290599998958629161673886099789010102226194668316684500618598595449227784903394260060015455220159779591366740'], ['271375729839567446696188359961925196920365319529062629304932048338190881206077379986946676257149532775205270704617447077979905578742925076320413725144406630756098884338996858315078201740897282749662892780593475238891810189449706162479644039415279899190545106544112062597755923401786424170623093859825517070779118293813102745582554159503649215376329092212446043256562952571943821805620999165097270947637408541000630708431403088142985045964534402555641073356744203907952132378775189638729532284517462764973958634832759499716630327926783071960852513365897068162415024774935406863615729273480667517848399426916539706132083987266251858601563427797415052363406838177473778795779597175607476450276118723067195289226468552795543137571031230438811542413266202572268343525206832289498959158892997798827952788853315560408063246583863630630990458942252133320104297689731677499906876634455498009644126983577277073003444810308719982137991', '3875820727394460400419869633973148548608647951123787913829403322770497699306254966790073146373971506193900033969022887887003734569427486637123284046102887179802388315419427717495379362368341055079431936477343075473472358941852710718599505494414973931671999072734269158726654561854188620576208033367719350259470145292674797566989931781526005773320611839886542848262863104971305053319696466487393523232691198326769552660353309970295226402740267556667045860202051844665535162545367651130317471703289541369040261833950273354054307398742206150252885069046183935033218471895416127653733810107727003948833588143322553610148980438275317181462740829962271849232259610825122285270312448257119767176588121463594053524643885764100246592945256260269102735872280081623075830611187485783630238339727767317430223705270450510462206216020146548278302584075981454435692052714641907242336879988468649998238573661018967442181981683353350886152552'], ['1639973207511535039284141821308368803080839944082635174519716147591219329782030088335181020293002911601760570804383497740289569356366504468871156801123016714098706973923951847098534842562917711968506636246276692904611296293846965998639815829877429663927230535667679645484905187465353156815683635843291688742908350504505689638405408347535687505712146263645510197095921227611888547058282134839871534054154395357325426673375621483330740933976428092536231657620673426175336125345461071062450475522314623939389471610081624227172400215116079711615736908246067065051413653634126054763410092745707063047887161919738012274886040146269049624683386967230989744610003468855209440511770530464043056019678027386856605917239079501902201397433940144416648121839727201631891804179239482007382195854725677482718520560475229979849532434651751050746689792482797192225989506986549465456306257643166474538428341730086018447919818834589610239995014', '652961843404395300982711272367706681168167134153485219139939144818979948587255719382912870855521784259776570756631913861426815873803941322472423460563284700830339852068410842893237494889071289714282253661379112166728891274529215676963762977879990482659848341205530985676183138333961213760539694576247608501944641658168295293768696912931542965568788266273866135641150153126325147743368753967992495902617961675681138141086633347833705059149479725501141226873844081739072946543631283407728351063940833617692093248934164718623388975985369797505710453209188660600118251685177072391838716945393098718119271531823731013219930828627371000135149843183285747645450322681907146877337740954106129286661068266340667364849215000164872194532728337756411232895448087157469473466630672078806493986916388681596057110884796490761407935503790211327192577545199918428471367665309572257680261534091381692436303919972773024955758487418399579685365']], 'e_prime_bold': [['1262457596262699919537946365285189969643447543946360410911590357914360831607184832253777666034638102071770458933583045340412304580373719792175786029197995879675341251832832057414117105494275286367403922425448918773733206012547336928251209044541511681065896215664336890542207972726005031418276792497760710199332307329937984409824699402948803665159098186300992924082688640507132941246693335416143340403788427263378472372658346825659165175867059814589863547033558557523787567682243508219041687440797526230396090150132779805691143441934632688097280001275800533114233536980488443936421680544045545510783640302934428168185997501646997475108718855206155301530148726606829676660085118490190303928683493239462305622611287777506639511198159290198293494978954685580057521464772437333623998185139323446461023987756231339913758808441483153188175940966881782088941591488282213701674609456126958873802396015835930515934026744431289101165447', '821349521027863936037493357637742180026655649725559419864390111507994125878697431407240743787749205292501752883404391062865016094235572440754489958109378499720697734749415615310979028321665447602193608282281782430219948042681865899795809626345938309628723810934996043691561820802199918981026676134138517070398888113941916597826615311699126482812423581136088865513289837545959298494551835209656922903893703011087581197208977714916383249070484690075253986486048811881845224238923375467983457672740255031782298066662830765104708594730826249975314123441071740869822705053034446357810880382700072382769316376754747339122688816166688767371918411657331683743190747139684006803596321498508941469528605195387913569201769848833246538740935074239990320301297718984337472772523891399038378485063917286371733484122677406653818033091805281742371990065133801898033186467201541243969326530791832091926774559701289218060232301785647076708365'], ['3295408204744488483926444848695225806685003190828107030708424060274701540682697787629957503201449536511720903167200225500441445599125790818182233097328049457802762099442432493520080514658974203803417525224734069304436797121955060935625789992409164993589428631825162178145501371231321059371942385727309184179972016314609013827311801504348878997018465364954468186517910306498039962099624190899849219212857216275259484059824071432320391662736909971239668543920222369203565209924187220961416382078059853845136919368018724397935188122960740987550411892056789987778176362556061179811463738249885283363695790273921658882678386319749876787860042858172716776577222086822673015488636798602352835101063493059629861325505548753160130464348391053855915835337480976258270934481897983145915085979197518522917392893718982476683977055413546416029105784286025779880061328810455769367226977344132325964575359591281260951035926085197778855375979', '1176307860290405617785203877747446171689856798406121087471458924762970116589387488108997526149852509842205727571350042768484003747967330408494976842442572971634894934323757633851289273830235824855913441375298467349763518753488159842907243042468688209823458773144805600552753238853440322334724040235019609598414230838106018406122617693394320109063856672955994378614600087452020750520989074653162213138035234607877976608684145662133696940856173867938891810197518821597417748667851331152030786003975483355294008061232980645022778099260131022344123281320685813884660692465754839368611645447349156663819338580655908921878752733035978882628404401605624358503091194270868790167256038029903801656823972698627347270498396006198680885807235644127930718744741305569996194803871082767815408183820976861366381072107462683495010473709528142026045770977764328163198985576851168758297972089569806581923851611534137634529473342774798804916875'], ['3914491199883871770019226477479469536574237450794746377094632383649932998081017973038540080883622961126408873102382905412928082662824259559993473029237760728673557361203336410708738885733073787496899315684815046393250848995353560851426219831089129777436084022753491930546746144759965563965999778691450084868324418889859986260538193149316764709254664704446056000438413607581596124400795356523059229999864889499724475359302261627277606829418372284018682684419617190668325106039745865186596088151110763157812397173711771754881465360261644641308841606233539402850578995091454749783937467691320958999984042577398437265833487016300011274684690842658160738080148965763680562803398953673403760285464714840111932360956133656139975586983518095963460563462178855880406714326193799479958711101183969233003963757493584231780504766128849194817966758523675330146937296937821286527144249841785943569669626609797888076376264248430360581544021', '1976942970273939295741883516616639467994509343266193609625792971358259472825097066839686094756123192841385174012013180076672412584174845067039152109825587200239296789758242614144878706947206419738086312582164733614922669917159275776427545544594299714027377852180501547387370974689145690506610523099213745842049480763498475763911089924313190402688495747173792174886111918269690395626825780772532787027479378318255204642125128829776844914852953470068156503187036831805607094192593208647653324634086030084454152813405305068055414633682330764840452711848523292014051774354277989734447323271655493705163043210817690462957957486533341528937842187348165518597510015053769193529254809531451124400080757191631005334429668710494656511086816387184420880111660208756962785050386356684119664586003774091463519144259991034570714706953360230043761110736754672292420514990598527198511881009399431127878836462686014867374693298190097795168838']]})
        >>> res.test_result
        'successful'
        """
        key = self.key
        shuffle_proof = election_data['shuffleProof']
        pi = generateShuffleProof(shuffle_proof)
        e_bold = generateElgamal(election_data['e_bold'])
        e_prime_bold = generateElgamal(election_data['e_prime_bold'])
        pk = mpz(self.election_data['publicKey'])
        self.test_result.addTestData('publicKey',pk)
        secparams = self.election_data['secparams']
        res = CheckShuffleProof(pi,e_bold,e_prime_bold,pk,secparams)
        return 'successful' if res else 'failed'

class DecryptionProofEvidenceTest(SingleTest):
    """docstring for DecryptionProofEvidenceTest."""
    @completness_decorate
    def runTest(self,election_data):
        """
        >>> res = dpet.runTest({'decryptionProof': [['1265358721032139380715781836337448558496182681624063784971190147244360987136460031992013940636589597506682956470290541513138343217394381404797835941248736535487535881702095702191224668494553955242973502791981174101473048846057982091374182196456799539850988721094686366485655150184934167919030653307307682797173065446782414596137834662703090559835449604662857272302500826784273953115540007608886238432042646909348623297533999105728406492383733741362853003953919928226380069675017675010869481437024222431098761095246670769409821643988334366230298091961119565499840906844046265870282316628525162698695925346130843707205722696625077228566366558729017078280460126071187332656675641725163162207409033439013619001081930181553528436399202990879869892613738587164794940822286756192320538383761398329689828405224714843942180158866330610381006456274518459554581306524815102861416019552314347156740247473129631193903326427544711586077821', ['3411075207717230689760177504251743624968174228152744221679605862775283686977995054417200316188541551440291312674156314091422323981447733213425664834613786058881440125711128549822898033699082739766082148584047719612984007934096542165318207289122899424500284853343611357804500705517291182252717722927174856095067501770205305469085861309247139121374674616239213086445547061016754602261629837576521209083343890512378230475284552911834584427672466960723983468355597468016808017166371658784555042778248914818131070873918718408831160147542007254236365392083682811371216827326354091545143963977993392785191216986352971818182279354680932284793059354855188004702845440219121769812125189123110535634144964499480848618536193405941260676393943691199011213971342029463290351627997262584104240182030382033990145249520342607685757914927680614968775259519688525531803070278715177801914749618192711396286598285761119915632666901809147810600920', '2047879116176365635250998334027082224511273487032272311259281693343940043301846628422359067453826901006181756904767559157082719709722175903980865407727975674247545017912383180687441630717747772848383065016365632345303381518845957609959288815570581246516669818452200242802341422111510118839201168626137890282826446237553242104848008704468450235683222625916493083404557839665924153104544247464682916591123892966531583696441912583224137208628582239638955437408178172516745761761629718980170906254329921929716619986437292435078237069778599109520487575777014430023019278976212290341793413811560636736094321891094261693442368608835735156408224954676039523913890438431897006975933272929530009755710897087112877988730561884015667641968400969606240801435699497695935009813476278410876877938401181049958210875474362124260961867720205933482955909723138169988698342540261675442151118964891601885083520857581195368744629756964926395970539', '1765830039633851570158350184378627594794450071224004835481988848433918688973902659042741060692543505616445675823546722594420536976764780109374940172180277426200903679284099085963081268318054691568488122911030318502430827908721323798948816035948038227490850364763954500529465289302471980394928393894865750271381502899312809261664146701477830347429754901352434055054260128011516969884548496332164166913322857535563593642418235359880109924683820045450755361996992157128877232271113231191882744592945308936260021554045523508531663445859131286942568500537503902463913481427761408244736952501687929966864326280721616189482838517213554353716997114379308821540731990409154358831904594900830864250531656411812953883897315124743852555471329614014969991288845817824846775869737304526380425017730231660027702083862204782307422964386433867580360973667217284406850627978786953973873523697707482840239713564991549227442054217897096251495697']], '1479162054827085959657859083905946613705766302193190169462686733257385167003730370406150576327050549191474666840862708773329106724861124660292609309353073803794546535997060229750309039924739641852130095889943710510438952789408466486325312833669179452330842722712916283319910623654720805919655180411941498100526401494656646577608425312765043074087761641245626422938519133770030275452092120889759581302844814672908689021344376993993525573974510516681096904940411241980882362263575383982685372871763233778121433386772282195986929571992501796832986771848017041733078388465956460148653069899363108406288473433825943270178253261299709046324965924220265579483069211603442844991239650328568565912432854306433204310288465702722568362426559765595116757251031937600826017102577371503539694167177754038568401854865097184397523361561556744682581021153610465799254769173152973223853254958786616411784581781478212587329287749083223679135255'], 'e_bold': [['3573457942231889976267774062662722803608177565254592653358563465597544940266529507081569242521487783148558986152658919141512398713211302225689978203852704512493084622264054075533830967455926488003115971217369989726841039430397517323812610237658458793542634015028809112354114565852190367062467023741672571649643111178190753622755910918217165328573769835124990638313869417362830354032170000090205258672213198227395846956081652302767410279953957888062045122026651817273854216125741448821027126192092830838681911015699839785611725935369160714941418313483907402849955226005061263973430991341406867892163380166418886032334126726709207281856852048156240891587617660514766566554737006298522462822650858117536339445307719393582555004260976289892473474293574538318172241508528125313109445192424000699437005553365884090299571605726059111603187401299522145726837667563126254247658059693241068962123590632234687340005517444943807053532713', '2609085856865318107713626694757434198695232857648245103442129644157640224541223099183069339182621830104655438483529572908183414533039845355957070037216744356976502442271464316882642034602601904997194183348713574942075882041369472258247735962852473257464236450190092941285121147210826156863058960789808844458449167060843502719739714088406237470323057261842906064588683778020750466931104771239169960136741675908303472839671791133077922852650791119382697987698092403106743732831135485578430541436805488647624736329626163816941657098108919261572097690878112871398493435066583898952239813543614009057080302434295743859183165103974117925058312405811487330616788041497880845697422164179554017428513808630749005302725110703012787791985886717922034590112751590144921339197991804549355884060965211753824129131358134217988051247772771508745619794740108234159195029952320012576374457651383282558522227126547755088279975087864276153052562'], ['51092347707105879920084655517569963537532524940049328024290697399061514706005482770992340040111059419270738042130441091176074887224732082431783320313143582622694195188118595504200484793751073084141115936713600187711374573397275736144483221617166851565200340359164440628729357101427139094902604457239636893701183981432399947677794274597601564466321884407796191959781210230263862707729771930523139790127711298941561693477758514183554398945515662411233018082842080323477863085553658839329985325068173122758633573990288066872832319090891323471787351282488651892075129492943560115476227123929669268309824880597121043223124245032986440256584803033788487335115578956430712053576508874340768671028826409795262311732389617804009424017705661584090675306246498499142185094191692424916984532970185746727435173426535784290167731078703438474208444171947436727211643918170642125942914254388570244817735630816389272199089478478905400923997', '635147803659206952310397352210334154085637431406818453067486950990030356933253013484550318332917553779021412563035996419857947395906939508236121473449323179109560382708447475595351845720258330873526610935359453834349732091465111555776529877110827616436512685927641300633588812753840119778592045845962549530983529508154556065382891042189655969600699525141902923119606853697252304939384538657652241580924635706593882941226321499251851321965415041807700610035345044393166876854995504612981920110413988672651268311832514164667767099898244011133852412800715319075419566223949716288975958737615199777279009407129371574298502445947196970550920348499393282756585697264386158054056113585027240968248792295505121615893074776686581502192434180854462568626042366591837344233516233128170387456911519416279328840850481139279779467624781516652368983653564909066938853176037292286766644924899067087150509566292514438843317282444736934112288'], ['1303399384475888052937697582091487950120540109213893372516116392820122756350271446497803089454985693255226684651167876254194351316053666978328992649536974340617683203359458059603232152024643425749847812377812438930455166739054560233233534424321322671689440959821864801118723244764555269970677498276065007069833010520218834363894567139244467138568085832076643305430499313571625369698779351245287374062657778769195526889947943305657328567217242784688016316014140675585590597253830003826251320192317761948240292877496745871135722103378373383554820097087136989704270731750980930058637809825463559510037114975205875865342489606171375340887389399624482676180216435865854974582549100060679066470364487887659296008411605434218199654270876555700739366680573282191820380465344023771072616930876632560733333983969693602890514722683306045294545541772652361170926633093532550826661485036965574087372811051558270462882111869052366704887073', '2670440767310486662905299922715038644136853812847006004738606831846488833659840695333646369190820844634158719186608437135492779106897377593067636508343271785229930197594769936615769055768096999370895932621453763700476447353586081841284569618735349386054649849286011582027779202115451443536021481964217168678311708942088009676038987444101630611523018337042914935806070500835506258593962817382594560923014330456292888909197075057775252115287822682287235316485984669085624954248824186834506582438631683673516796808768593651220697178113529773332042726555614536202930822690612148343568351713250285952167696010266122673900039719961193988524085108102839530758100926116619110005751310370998595794252738741606424320757113193892127162458685820744513790345432194044032782281354051145210275639094909655759986814978591089050110368734967161279588462545526222528083061941919348577661668448622084352548237476231794523846914007283244528577602']], 'decryption': ['1022515636834304568338530955408098580734488050967574796458735411874389526687922802845835328335744075190543736928456638151799727007605864703418872547556279136429918240013201576865596762389022684447675276563670519407067681460071594430857713668010122907255563669770462942783977365457366880825854350134317208235172253105785525533451441357412731801298449004554102585606812139732422650435098410474299459480278425710323037624798833274788102721595314645253631942813798874401143227974948435024714642029884243487714062333046123045440227738578178322246371873231539411881108851368815395989435100170163482077220265577796786045031132586872229204580972645268731026665101389862846286073710738896451423499463298529305554070480685654230198201259323220722602658593061746505861552497870606906176818584337906764485049874345074678938451206423816508415511637621571415790846730362515472362191367412627158375163479190573884313994751891217296583227981', '3637886505155529718585013062351648361340432005291634055951393670262836363520763636484078311534826865180501570408637223008333176267149150277871072677368924786832870446375979129992100097344971961577615211874891998757069758157674973315673411388530985602853116234830554146114003327544488062967801470881304418472164261075184409190263082473822446323835058095236422008894410233370096366498783966229134309367848463893335128868662101910146039281803481965132203313227659815267712101049180439945192482347495400797151429281854335451141724468921276061141359816542693092917328947127531035318998645817193076649379428799870515508752001296462899556262653327062518669668703496577377650553048162598165621693541532263187370915338454789030132587445442501711190838981868818787601455106389371657929407463780882450951347283242233282121778237451404315525054195800858114364718301317237219837653164678135964738862414911865199698197611884154402697426317', '3432609334079079612286504642415731295126107993236664400484554993439499831802379907251328211977361967446007683492475817363608114470546633530116324108709629128927323874534875257518007044997737904361749539866199074415790974443738981082845380093313796098556232187844137089471412288316089499115395285833230913532508304293472369383344107590069753333858747887809685296727831812381312318857458654855206820041047259125143598122654002789306806097969514152345058183470269458798001612254020219244797338115146597257737854850160792130183433212390979993045805425486534072787269377517978675002595875923290884150551793297690439541133357978404633635824815484398584986281321734172838518869079444464261412471276176558615065634835975087573021995641954618033771910699669521242692681866127570540765384920921303551240831143145387418323844488174604669867500855805454208610099288663318825469549064168001599922591562136784231802773314153159133170573089'], 'pk_j': '3201698212372225591658453783168168951275784006752333889126521587653034519261557303524075629648459904856438972611991744335511254337996689709804098377454199099561093086203560944306330244066388731269936231700758945086651762373713583677424413325934051836484567831798063118139932145683479899815064397335219503126284591698188403296119474725416062468771000705041465886039073084868932309439700989084547625030234582135098004387654854422994000763949998844062228333673653082509160116002529605430949704657691128800762525616574420089635686717298908405957083717438813057362247840720644972749757581804048388988807520084202967823226243018042121805292717234057825660078770323672712003893086255380094272876373852299698555735296827083105846917093869395749376347706930683775163550316756471209549152680333941331148037066608454193420555106934123675958192962473817479134747374902639157296264900049248007333306660550257197048162003657435172762369519'})
        >>> res.test_result
        'successful'
        """
        key = self.key
        au_id = int(self.id[-1]) -1
        decryptionProof = election_data['decryptionProof']
        pi_prime = generateDecryptionProof(decryptionProof)
        pk_j = mpz(election_data['pk_j'])
        e_bold = generateElgamal(election_data['e_bold'])
        decryption = mpzList(election_data['decryption'])
        secparams= self.election_data['secparams']
        res = CheckDecryptionProof(pi_prime, pk_j, e_bold, decryption, secparams)
        return 'successful' if res else 'failed'








if __name__ == '__main__':
    import doctest
    from chvote.Common.SecurityParams import secparams_l1,secparams_l2,secparams_l3
    bpe_test = BallotProofEvidenceTest("1.1","TEST","TEST","ballot")
    bpe_test.election_data = {'publicKey':'2721018155699489411542213056148012074052548113726642889701705112755974737451318870255648939276536172308726828572986940131789368436613219844915287835481165590734761195639541435331051524855521854004971090570064778435633204661632995007204823589930770485222393106033645761082534695313982005400917478953969095109685517221834872259559238200644959055481991881762262704667193329088703278187372296350722554961668836448757383681843902280286615449697297915167726451728816189067203276968235029469858344878565257106922744103950443320762023379659397505592745669635791069760162432753771501779025429624848121258948522679005382255951348665467461363269408313071461569127288632157629560144718895730885155065571532713782441000584472697839126343544473577771121534155938149261811636395690149372622474785591950134351748590999532278350797080995783529620122118764546357338006914128794048621503454893219354071153072681922990346519642879590224417334562','secparams': secparams_l3}
    cpe_test = ConfirmationProofEvidenceTest("1.1","TEST","TEST","confirmation")
    cpe_test.election_data = {'secparams': secparams_l3}
    spe_test = ShuffleProofEveidenceTest("1.1","TEST","TEST","shuffleProof")
    spe_test.election_data = {'publicKey':'3472538235133839389015944286952315604040689209664186848798473856666132978063501893882726951987017755257908514622890077497900974546741464247724823886880667730733405188594502069185279622070855196994013194272006008147824646494376493105061154358635810662414569357908786840704250719607345490347329972445544184889884761990101639889398166900457354032927430720293819401572708052946354591498258180901242459233974472058984500205118770465159273586181411251298575509605329423345517149194725402342450043717416121965054076892084096251250030982637380158431284226139870672610757036743348319579456977554066423727543214711892400027022667701714700709441058774269797372995558483809677719629624858408968124658893731141431698781698062089298666548161926054089972547108604679435478693379203452902238806747999621095534151665940272758131380607186197133272652066276058131595865737110370238537597996086783115670024195575781248547072840030960234570985330','secparams': secparams_l3,}
    dpe_test = DecryptionProofEvidenceTest("1.1","TEST","TEST","decryptionProof")
    dpe_test.election_data = {'secparams': secparams_l3}
    doctest.testmod(extraglobs = {'bpet': bpe_test, 'cpet': cpe_test, 'spet': spe_test, 'dpet': dpe_test})
